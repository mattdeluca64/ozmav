/*
	draw.c - Chip-8 screen drawing & related functions
*/

#include "globals.h"

unsigned char characterSet[] = {
	0xF0, 0x90, 0x90, 0x90, 0xF0,	//0
	0x20, 0x60, 0x20, 0x20, 0x70,	//1
	0xF0, 0x10, 0xF0, 0x80, 0xF0,	//2
	0xF0, 0x10, 0xF0, 0x10, 0xF0,	//3
	0x90, 0x90, 0xF0, 0x10, 0x10,	//4
	0xF0, 0x80, 0xF0, 0x10, 0xF0,	//5
	0xF0, 0x80, 0xF0, 0x90, 0xF0,	//6
	0xF0, 0x10, 0x20, 0x40, 0x40,	//7
	0xF0, 0x90, 0xF0, 0x90, 0xF0,	//8
	0xF0, 0x90, 0xF0, 0x10, 0xF0,	//9
	0xF0, 0x90, 0xF0, 0x90, 0x90,	//A
	0xE0, 0x90, 0xE0, 0x90, 0xE0,	//B
	0xF0, 0x80, 0x80, 0x80, 0xF0,	//C
	0xE0, 0x90, 0x90, 0x90, 0xE0,	//D
	0xF0, 0x80, 0xF0, 0x80, 0xF0,	//E
	0xF0, 0x80, 0xF0, 0x80, 0x80	//F
};

void prepareChars()
{
	memcpy(&interpreter.memory[0], characterSet, 0x10 * 5);
}

void resizeScreen()
{
	SDL_Event event;
	event.type = SDL_VIDEORESIZE;
	event.resize.w = program.scrWidth * program.zoomFactor;
	event.resize.h = program.scrHeight * program.zoomFactor;
	SDL_PushEvent(&event);
}

void drawScreen()
{
	int i, j;
	for(i = 0; i < program.scrHeight; i++) {
		for(j = 0; j < program.scrWidth; j++) {
			if(interpreter.screen[j][i]) drawRect(j, i, 1, 1, (program.colorMode ? program.colWhite : program.colGreen));
		}
	}
}

void drawRect(int x, int y, int w, int h, SDL_Color col)
{
	SDL_Rect rect;
	rect.x = x * program.zoomFactor;
	rect.y = y * program.zoomFactor;
	rect.w = w * program.zoomFactor;
	rect.h = h * program.zoomFactor;
	SDL_FillRect(program.screen, &rect, SDL_MapRGB(program.screen->format, col.r, col.g, col.b));
}
